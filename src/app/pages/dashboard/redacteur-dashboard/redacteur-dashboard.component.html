<h2>Bienvenue R√©dacteur üìù</h2>

<!-- üîπ Bouton pour ouvrir la pop-up d‚Äôajout -->
<button (click)="showCreateModal = true" class="btn btn-success">‚ûï Ajouter un article</button>

<!-- üü¢ POPUP CREATION ARTICLE -->
<div class="modal" *ngIf="showCreateModal">
  <div class="modal-content">
    <h3>Cr√©er un nouvel article</h3>
    <form (ngSubmit)="addArticle()" #formRef="ngForm">
      <input type="text" name="title" [(ngModel)]="newArticle.title" placeholder="Titre" required />
      <br />
      <textarea name="content" [(ngModel)]="newArticle.content" placeholder="Contenu" required></textarea>
      <br />
      <input type="text" name="image" [(ngModel)]="newArticle.image" placeholder="URL de l‚Äôimage" />
      <br />
      <input type="text" name="tags" [(ngModel)]="newArticle.tags" placeholder="Tags (s√©par√©s par des virgules)" />
      <br />
      <button type="submit" [disabled]="formRef.invalid" class="btn btn-primary">Cr√©er</button>
      <button type="button" (click)="showCreateModal = false" class="btn btn-secondary">Annuler</button>
    </form>
  </div>
</div>

<!-- üü° POPUP MODIFICATION ARTICLE -->
<div class="modal" *ngIf="showEditModal">
  <div class="modal-content">
    <h3>Modifier l‚Äôarticle</h3>
    <form (ngSubmit)="updateArticle()" #editFormRef="ngForm">
      <input type="text" name="title" [(ngModel)]="editForm.title" placeholder="Titre" required />
      <br />
      <textarea name="content" [(ngModel)]="editForm.content" placeholder="Contenu" required></textarea>
      <br />
      <input type="text" name="image" [(ngModel)]="editForm.image" placeholder="URL de l‚Äôimage" />
      <br />
      <input type="text" name="tags" [(ngModel)]="editForm.tags" placeholder="Tags (s√©par√©s par des virgules)" />
      <br />
      <button type="submit" [disabled]="editFormRef.invalid" class="btn btn-primary">Enregistrer</button>
      <button type="button" (click)="showEditModal = false" class="btn btn-secondary">Annuler</button>
    </form>
  </div>
</div>

<hr />

<!-- üîΩ Liste des articles -->
<h3>Liste des articles</h3>

<div *ngIf="loading">Chargement...</div>
<div *ngIf="!loading && articles.length === 0">Aucun article trouv√©.</div>

<div *ngIf="!loading && articles.length > 0">
  <div *ngFor="let article of articles" class="article-card">
    <h4>{{ article.title }}</h4>
    <img [src]="article.image" alt="image" width="150" />
    <p>{{ article.content }}</p>
    <p><strong>Auteur :</strong> {{ article.authorDetails?.username || 'Anonyme' }}</p>
    <p><strong>Tags :</strong> {{ article.tags.join(', ') }}</p>

    <!-- Le bouton "Modifier" s'affiche uniquement si l'article appartient au r√©dacteur connect√© -->
    <button *ngIf="article.authorDetails?._id === currentUserId"
            class="btn btn-primary"
            (click)="openEditModal(article)">Modifier</button>
  </div>
</div>
